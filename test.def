Bootstrap: docker
From: condaforge/miniforge3:latest


%post

# Update packages
apt-get -y update
apt-get -y upgrade

# install mamba (replaces conda, but much faster):
eval "$(conda shell.bash hook)"
conda install -y mamba 

# install metawrap:
mamba create -y --name metawrap-env --channel ursky metawrap-mg=1.3.2
conda activate metawrap-env


# To fix the CONCOCT endless warning messages in metaWRAP=1.2+, run
conda install -y blas=2.5=mkl


# Remove unneeded files
apt-get -y clean
rm -rf /var/lib/apt/lists/*
conda clean -yqa


%test

eval "$(conda shell.bash hook)"
conda activate metawrap-env



%help

Containerized Conda environment using miniforge3.
When using the container, activate with:
    eval "$(conda shell.bash hook)"
    conda activate metawrap-env
